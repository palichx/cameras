# VideoGuard - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker

## üöÄ –ó–∞–ø—É—Å–∫ –∑–∞ 3 –∫–æ–º–∞–Ω–¥—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏)
git clone <your-repo-url>
cd videoguard

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
make dev-up

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:3000
```

### –î–ª—è production

```bash
# 1. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—ã
make build

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
make up

# 3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ
# Frontend: http://localhost:3000
# Backend:  http://localhost:8001
```

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 2.0+
- 4GB RAM
- 20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

## üõ†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `make dev-up` | –ó–∞–ø—É—Å—Ç–∏—Ç—å dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ |
| `make dev-down` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ |
| `make up` | –ó–∞–ø—É—Å—Ç–∏—Ç—å production |
| `make down` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å production |
| `make logs` | –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ |
| `make clean` | –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë |

## üìù –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ?

1. **MongoDB** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 27017
2. **Backend** (FastAPI) –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 8001
3. **Frontend** (React) –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 3000

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Docker network.

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make health

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
curl http://localhost:8001/api/          # Backend
curl http://localhost:3000/health         # Frontend
```

## üé• –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∫–∞–º–µ—Ä—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ö–∞–º–µ—Ä—ã"
3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É"
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–∞–º–µ—Ä—ã (RTSP/HTTP MJPEG/HTTP Snapshot)
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä RTSP –∫–∞–º–µ—Ä—ã:
```
–ù–∞–∑–≤–∞–Ω–∏–µ: –í—Ö–æ–¥–Ω–∞—è –¥–≤–µ—Ä—å
–¢–∏–ø: RTSP
URL: rtsp://192.168.1.100:554/stream1
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: admin
–ü–∞—Ä–æ–ª—å: 12345
```

### –ü—Ä–∏–º–µ—Ä HTTP MJPEG:
```
–ù–∞–∑–≤–∞–Ω–∏–µ: –ì–∞—Ä–∞–∂
–¢–∏–ø: HTTP MJPEG
URL: http://192.168.1.50:8080/video
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: admin
–ü–∞—Ä–æ–ª—å: admin123
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.yml`:

```yaml
services:
  frontend:
    ports:
      - "8080:80"  # –ò–∑–º–µ–Ω–∏—Ç—å 3000 –Ω–∞ 8080
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö MongoDB

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.yml`:

```yaml
mongodb:
  environment:
    MONGO_INITDB_ROOT_USERNAME: your_user
    MONGO_INITDB_ROOT_PASSWORD: your_password

backend:
  environment:
    - MONGO_URL=mongodb://your_user:your_password@mongodb:27017
```

## üì¶ Backup –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –°–æ–∑–¥–∞—Ç—å backup
```bash
make db-backup
# Backup —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ ./backups/
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
```bash
make db-restore
# –í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ backup
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
sudo lsof -i :3000
sudo lsof -i :8001

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞
```bash
# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã
make prune

# –û—á–∏—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Å–∏ —Å –∫–∞–º–µ—Ä
docker exec videoguard-backend rm -rf /app/recordings/*
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
```bash
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
make clean
make build
make up
```

### MongoDB –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
make db-logs

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å volume
docker volume rm videoguard_mongodb_data
make up
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
```bash
docker stats
```

### –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
```bash
make backend-logs   # –õ–æ–≥–∏ backend
make frontend-logs  # –õ–æ–≥–∏ frontend
make db-logs        # –õ–æ–≥–∏ MongoDB
```

## üîí Production —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ MongoDB** –≤ `docker-compose.yml`
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS** - —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –¥–æ–º–µ–Ω –≤–º–µ—Å—Ç–æ `*`
3. **–î–æ–±–∞–≤—å—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –¥–ª—è HTTPS
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ backup** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –ë–î
5. **–í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–æ–±–∞–≤—å—Ç–µ Prometheus/Grafana

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Docker](./DOCKER_README.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ HTTP –∫–∞–º–µ—Ä–∞–º](./HTTP_CAMERAS_GUIDE.md)
- [Makefile –∫–æ–º–∞–Ω–¥—ã](./Makefile)

## üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `make logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health: `make health`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [DOCKER_README.md](./DOCKER_README.md) —Ä–∞–∑–¥–µ–ª Troubleshooting

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!

–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
- –î–æ–±–∞–≤—å—Ç–µ –∫–∞–º–µ—Ä—ã
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–µ—Ç–µ–∫—Ü–∏—é –¥–≤–∏–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ
- –ò–∑—É—á–∏—Ç–µ –∞—Ä—Ö–∏–≤ —Å–æ–±—ã—Ç–∏–π
